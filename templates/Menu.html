<!DOCTYPE html>
<html lang="en">
<head>
    <title>Tuffy Tacos</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/tuffytaco.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='CSSFiles/Menu.css') }}">

</head>






<body>
    <header>
    <div class="header-grid">
        <a href="{{ url_for('index') }}">
            <img id="tuffy" src="{{ url_for('static', filename='images/tuffytaco.png') }}" height="80" width="80" alt="TuffyTacos">
        </a>
        <h1>Tuffy Tacos - Menu</h1>

        <div class="header-links">
            <a href="{{ url_for('index') }}">Return to homepage</a>
            <a href="{{ url_for('cart') }}">View Cart</a>
        </div>
    </div>
    </header>











<div class="cart-container">
    <h2>Your Cart</h2>
    <div id="cart-box">
    </div>
</div>

<script>
async function loadCart() {
    const res = await fetch("/api/get-cart");
    const data = await res.json();

    if (!data.success) {
        document.getElementById("cart-container").innerHTML = "<p>Your cart is empty.</p>";
        return;
    }

    let html = "";
    data.items.forEach(item => {
        html += `
            <div class="cart-item">
                <strong>${item.name}</strong> x${item.quantity}
                â€” $${item.price}
            </div>
        `;
    });

    document.getElementById("cart-box").innerHTML = html;
    
}

 
loadCart();

async function addToCart(idNum, name, price) {
    const response = await fetch("/api/add-to-cart", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            idNum: idNum,
            name: name,
            price: price * quantity,
            quantity: 1
        })
    });

    const data = await response.json();

    if (data.success) {
        loadCart();    
    }

    alert(data.message);
}
</script>


























    <main>
        <div id="menu-container"></div>
    </main>

    <script>
    function displayMenuJSON(jsonData) {
        let grid = '<div class="menu-grid">';

        jsonData["menu_list"].forEach(row => {
            grid += `
                <div class="item-box">
                    <h2>${row.name}</h2>
                    <p>Price: $${row.price.toFixed(2)}</p>
                    <button class="add-btn" data-id="${row.idNum}">
                        Add to Cart
                    </button>
                </div>
            `;
        });

        grid += "</div>";
        document.getElementById("menu-container").innerHTML = grid;

         
        document.querySelectorAll(".add-btn").forEach(button => {
            button.addEventListener("click", async () => {
                const itemId = parseInt(button.dataset.id);

                const response = await fetch("/api/add-to-cart", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ item_id: itemId })
                });

                const data = await response.json();
               
            });
        });
    }

    fetch("{{ url_for('static', filename='menuLists.json') }}")
        .then(r => r.json())
        .then(displayMenuJSON);
</script>
</body>