<!DOCTYPE html>
<html lang="en">
<head>
    <title>Tuffy Tacos</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/tuffytaco.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='CSSFiles/order-history.css') }}">

</head>

 <header>
    <div class="header-grid">
        <a href="{{ url_for('index') }}">
            <img id="tuffy" src="{{ url_for('static', filename='images/tuffytaco.png') }}" height="80" width="80" alt="TuffyTacos">
        </a>
        <h1>Tuffy Tacos - Order History</h1>

        <div class="header-links">
            <a href="{{ url_for('cart') }}">View Cart</a>
            <a href="{{ url_for('index') }}">Return to homepage</a>
            
        </div>
    </div>
    </header>



    <h1>Your Order History</h1>

<div id="history-container" class="history-grid"></div>

 

<script>
async function loadOrderHistory() {
    const res = await fetch("/api/order-history");
    const data = await res.json();

    const container = document.getElementById("history-container");

    if (!data.success || !data.orders || data.orders.length === 0) {
        container.innerHTML = "<p>No order history found.</p>";
        return;
    }

    let html = "";

    data.orders.forEach(order => {
        let total = parseFloat(order.total); // ensure total is a number

        html += `
        <div class="order-box">
            <h2>Order Total: $${total.toFixed(2)}</h2>
            <h3>Items:</h3>
            <ul>
                ${order.items
                    .map(item => {
                        const price = parseFloat(item.price);
                        const quantity = parseInt(item.quantity);
                        return `<li>${item.name} (x${quantity}) â€” $${price.toFixed(2)}</li>`;
                    })
                    .join("")}
            </ul>
        </div>
        `;
    });

    container.innerHTML = html;
}
loadOrderHistory();
</script>